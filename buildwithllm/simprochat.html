<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SimProChat</title>
<style>
html,body{height:100%;overflow:hidden;}body{font-family:Arial,sans-serif;margin:0;padding:0;display:flex;flex-direction:column;background:#f0f0f0;height:100vh;}#apiKeySection{padding:10px;background:#e0e0e0;border-bottom:1px solid #ccc;}#mainContent{display:flex;flex:1;overflow:hidden;}#mainColumn{flex:1;display:flex;flex-direction:column;padding:10px;background:#fff;}#sidebar{width:300px;padding:10px;display:flex;flex-direction:column;overflow-y:auto;background:#fff;transition:width 0.3s ease;}#sidebar.hidden{width:0;padding:0;overflow:hidden;}#sidebarToggle{width:5px;background:#007bff;cursor:pointer;transition:background 0.3s ease;}#sidebarToggle:hover{background:#0056b3;}.chatRow{margin-bottom:3px;padding:3px;border-radius:5px;position:relative;}textarea,input{width:100%;box-sizing:border-box;padding:5px;border:1px solid #ccc;border-radius:3px;margin-bottom:5px;}#chatHistory{flex:1;overflow-y:auto;margin-bottom:10px;}#chatInput{padding:10px;border-top:1px solid #ccc;}#errorMessage{color:red;padding:10px;}button{padding:5px 10px;background:#007bff;color:#fff;border:none;border-radius:3px;cursor:pointer;}button:hover{background:#0056b3;}.editableText{min-height:1em;border:1px solid transparent;padding:5px;border-radius:3px;display:inline-block;cursor:default;width:calc(100% - 10px);white-space:pre-wrap;word-wrap:break-word;}.editableText:focus{outline:none;}.editingMode{border:2px solid #007bff;border-radius:5px;padding:5px;cursor:text;}.messageRole{font-weight:bold;margin-right:5px;}#zeroshotHistory{margin-top:10px;max-height:300px;overflow-y:auto;}pre{position:relative;background-color:white;white-space:pre-wrap;word-wrap:break-word;font-family:Arial,sans-serif;margin:10px 0;}pre.normal{padding:0;background-color:white;}pre.codeblock{padding:10px;background-color:#f4f4f4;padding-top:25px;border-radius:3px;}pre code{font-family:monospace;}.codeLanguage{font-size:0.8em;color:#888;position:absolute;top:0;left:0;padding:2px 5px;background:#f4f4f4;border-bottom-right-radius:3px;border-right:1px solid #ddd;border-bottom:1px solid #ddd;}.copyButton{position:absolute;top:5px;right:5px;background:white;color:#007bff;border:1px solid #007bff;border-radius:3px;padding:2px 5px;cursor:pointer;font-size:12px;}.copyButton:hover{background:#007bff;color:white;}.previewButton{position:absolute;bottom:5px;right:5px;background:white;color:green;border:1px solid green;border-radius:3px;padding:2px 5px;cursor:pointer;font-size:12px;}.previewButton:hover{background:green;color:white;}@keyframes spin{0%{transform:rotate(0deg);}100%{transform:rotate(360deg);}}.loadingSpinner{display:inline-block;width:10px;height:10px;border:2px solid rgba(255,255,255,.3);border-radius:50%;border-top-color:#fff;animation:spin 1s ease-in-out infinite;margin-right:5px;}button:disabled{opacity:0.7;cursor:not-allowed;}.deleteMessageBtn{position:absolute;right:5px;top:5px;color:#ff4d4d;border:none;font-weight:bold;font-size:14px;cursor:pointer;padding:0;} .chatRow:hover .deleteMessageBtn{display:inline;} .deleteMessageBtnContainer{display:none;position:absolute;right:0;top:0;bottom:0;width:30px;}#youtubeSection{margin-bottom:10px;}#youtubeFrame{width:100%;height:200px;border:none;}#youtubeUrl{text-align:left;}@media (max-width: 768px){#mainContent{flex-direction:column;}#sidebar{width:100%;}}
</style>
</head>
<body>
<div id="apiKeySection"><input type="password" id="apiKeyInput" placeholder="Enter your API key" oninput="saveApiKey()"></div>
<div id="mainContent"><div id="mainColumn"><div id="chatHistory"></div><div id="chatInput"><textarea id="userInput" rows="3" placeholder="Enter your message... (Press Enter to send, Shift+Enter for new line)"></textarea><button id="sendButton" onclick="sendMessage()">Send</button></div></div><div id="sidebarToggle" onclick="toggleSidebar()"></div><div id="sidebar"><div id="youtubeSection"><input type="text" id="youtubeUrl" value="https://www.youtube.com/embed/jfKfPfyJRdk?autoplay=1" placeholder="Enter YouTube embed URL" oninput="updateYoutubeUrl()"><iframe id="youtubeFrame" src="https://www.youtube.com/embed/jfKfPfyJRdk?autoplay=1" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe></div><h3>Zero-shot Query</h3><input type="text" id="zeroshotSystemPrompt" placeholder="System prompt" value="Explain this to me briefly"><textarea id="zeroshotInput" rows="5" placeholder="Enter your zero-shot query..."></textarea><button id="zeroshotButton" onclick="sendZeroshotQuery()">Send Zero-shot</button><div id="zeroshotHistory"></div></div></div>
<div id="errorMessage"></div>
<script>
const apiUrl='https://api.openai.com/v1/chat/completions';let chatHistory=[],zeroshotHistory=[],isMainChatProcessing=false,isZeroshotProcessing=false;let DEFAULT_SYSTEM_PROMPT="Use less word, be concise and honest.";function saveApiKey(){const apiKey=document.getElementById('apiKeyInput').value;localStorage.setItem('simproChatApiKey',apiKey);}function getApiKey(){return localStorage.getItem('simproChatApiKey')||'';}function loadApiKey(){const apiKey=getApiKey();document.getElementById('apiKeyInput').value=apiKey;}async function fetchAIResponse(messages){const apiKey=getApiKey();if(!apiKey){throw new Error('API key not set. Please enter your API key.');}try{const headers={'Content-Type':'application/json','Authorization':`Bearer ${apiKey}`};const body={model:"gpt-4o",messages:messages,temperature:1};const response=await fetch(apiUrl,{method:'POST',headers:headers,body:JSON.stringify(body)});if(!response.ok){const errorData=await response.json();throw new Error(`API error: ${errorData.error.message}`);}const data=await response.json();return data.choices[0].message.content;}catch(error){console.error('Error:',error);throw error;}}function formatContent(content){let formattedContent=`<pre class="normal">${content}</pre>`;formattedContent=formattedContent.replace(/```(\w+)?\n([\s\S]*?)```/g,function(match,lang,code){const language=lang||'plaintext';let previewButton='';if(language==='html'){previewButton=`<button class="previewButton" onclick="previewHTML(this)">Preview</button>`;}return `<pre class="codeblock"><div class="codeLanguage">${language}</div><code>${escapeHtml(code)}</code><button class="copyButton" onclick="copyCode(this)">Copy</button>${previewButton}</pre>`;});return formattedContent;}function escapeHtml(html){return html.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&#39;');}function createMessageElement(content,role,index){const div=document.createElement('div');div.className='chatRow';let isEditing=false;const editableDiv=document.createElement('pre');editableDiv.className='editableText normal';editableDiv.contentEditable=true;editableDiv.innerHTML=`<span class="messageRole">${role}:</span> ${formatContent(content)}`;editableDiv.addEventListener('dblclick',function(e){if(!isEditing){isEditing=true;editableDiv.innerText=content;editableDiv.classList.add('editingMode');editableDiv.focus();e.stopPropagation();}});editableDiv.addEventListener('keydown',function(e){if(e.key==='Escape'){e.preventDefault();finishEditing();}});function finishEditing(){isEditing=false;content=editableDiv.innerText.trim();editableDiv.classList.remove('editingMode');editableDiv.innerHTML=`<span class="messageRole">${role}:</span> ${formatContent(content)}`;if(index>=0){chatHistory[index].content=content;}else{DEFAULT_SYSTEM_PROMPT=content;}}document.addEventListener('click',function(e){if(isEditing&&!editableDiv.contains(e.target)){finishEditing();}});div.appendChild(editableDiv);if(index!==-1){const deleteBtnContainer=document.createElement('div');deleteBtnContainer.className='deleteMessageBtnContainer';const deleteBtn=document.createElement('button');deleteBtn.className='deleteMessageBtn';deleteBtn.textContent='x';deleteBtn.onclick=function(){if(index>=0){chatHistory.splice(index,1);}else{DEFAULT_SYSTEM_PROMPT="Use less word, be concise and honest.";}updateChatDisplay();};deleteBtnContainer.appendChild(deleteBtn);div.appendChild(deleteBtnContainer);}return div;}function copyCode(button){const codeBlock=button.closest('pre');const codeElement=codeBlock.querySelector('code');const codeContent=codeElement.textContent;navigator.clipboard.writeText(codeContent);button.textContent='Copied';setTimeout(()=>button.textContent='Copy',1600);}function previewHTML(button){const codeBlock=button.closest('pre');const codeElement=codeBlock.querySelector('code');const htmlContent=codeElement.textContent.trim();const newWindow=window.open('','_blank');newWindow.document.open();newWindow.document.write(htmlContent);newWindow.document.close();}function updateChatDisplay(){const chatHistoryDiv=document.getElementById('chatHistory');chatHistoryDiv.innerHTML='';chatHistoryDiv.appendChild(createMessageElement(DEFAULT_SYSTEM_PROMPT,"system",-1));chatHistory.forEach((msg,index)=>{chatHistoryDiv.appendChild(createMessageElement(msg.content,msg.role,index));});chatHistoryDiv.scrollTop=chatHistoryDiv.scrollHeight;}function updateZeroshotDisplay(){const zeroshotHistoryDiv=document.getElementById('zeroshotHistory');zeroshotHistoryDiv.innerHTML='';zeroshotHistory.forEach((item)=>{const div=document.createElement('div');div.className='chatRow';div.innerHTML=`<div><strong>System:</strong> ${item.system}</div><div><strong>User:</strong> ${item.user}</div><div><strong>assistant:</strong> ${formatContent(item.assistant)}</div>`;zeroshotHistoryDiv.appendChild(div);});zeroshotHistoryDiv.scrollTop=zeroshotHistoryDiv.scrollHeight;}function setButtonLoadingState(buttonId,isLoading){const button=document.getElementById(buttonId);if(isLoading){button.innerHTML='<span class="loadingSpinner"></span>Sending...';button.disabled=true;}else{button.innerHTML='Send';button.disabled=false;}}async function sendMessage(){if(isMainChatProcessing)return;const userInput=document.getElementById('userInput');if(userInput.value.trim()==='')return;const userMessage=userInput.value;chatHistory.push({role:"user",content:userMessage});updateChatDisplay();userInput.value='';try{isMainChatProcessing=true;setButtonLoadingState('sendButton',true);const response=await fetchAIResponse([{role:"system",content:DEFAULT_SYSTEM_PROMPT},...chatHistory]);chatHistory.push({role:"assistant",content:response});updateChatDisplay();}catch(error){document.getElementById('errorMessage').textContent=`Error: ${error.message}`;}finally{isMainChatProcessing=false;setButtonLoadingState('sendButton',false);}}async function sendZeroshotQuery(){if(isZeroshotProcessing)return;const zeroshotSystemPrompt=document.getElementById('zeroshotSystemPrompt').value;const zeroshotInput=document.getElementById('zeroshotInput');if(zeroshotInput.value.trim()==='')return;const messages=[{role:"system",content:zeroshotSystemPrompt},{role:"user",content:zeroshotInput.value}];try{isZeroshotProcessing=true;setButtonLoadingState('zeroshotButton',true);const response=await fetchAIResponse(messages);zeroshotHistory.push({system:zeroshotSystemPrompt,user:zeroshotInput.value,assistant:response});updateZeroshotDisplay();zeroshotInput.value='';}catch(error){document.getElementById('errorMessage').textContent=`Error: ${error.message}`;}finally{isZeroshotProcessing=false;setButtonLoadingState('zeroshotButton',false);}}function updateYoutubeUrl(){const urlInput=document.getElementById('youtubeUrl');const iframe=document.getElementById('youtubeFrame');const newSrc=`${urlInput.value}${urlInput.value.includes('?')?'&':'?'}autoplay=1`;iframe.src=newSrc;}function toggleSidebar(){const sidebar=document.getElementById('sidebar');sidebar.classList.toggle('hidden');}window.onload=function(){loadApiKey();updateChatDisplay();const userInput=document.getElementById('userInput');userInput.addEventListener('keydown',function(e){if(e.key==='Enter'&&!e.shiftKey){e.preventDefault();sendMessage();}});}
</script>
</body>
</html>